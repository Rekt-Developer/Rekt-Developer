name: üöÄ Ultimate Profile Visuals & Automation

on:
  schedule:
    - cron: "0 */6 * * *"  # Runs every 6 hours
  workflow_dispatch:
  push:
    branches: ["main"]

env:
  METRICS_TOKEN: ${{ secrets.METRICS_TOKEN }}
  GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}

jobs:
  # Generate Comprehensive Profile Metrics
  comprehensive-metrics:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: üîç Checkout Repository
        uses: actions/checkout@v4

      - name: üìä Generate Metrics Data
        uses: lowlighter/metrics@latest
        with:
          token: ${{ env.METRICS_TOKEN }}
          user: likhonisaac
          base: |
            header
            activity
            community
            repositories
            metadata
          plugin_languages: yes
          plugin_languages_indepth: yes
          plugin_habits: yes
          plugin_habits_charts: yes
          plugin_achievements: yes
          plugin_achievements_display: detailed
          plugin_isocalendar: yes
          plugin_lines: yes
          plugin_stargazers: yes
          plugin_discussions: yes

  # Generate Advanced SVG and GIF Animations
  generate-visuals:
    runs-on: ubuntu-latest
    steps:
      - name: üîÑ Checkout Repository
        uses: actions/checkout@v4

      # Generate Snake Animation in Multiple Themes
      - name: üêç Snake Contribution Animations
        uses: Platane/snk/svg-only@v3
        with:
          github_user_name: likhonisaac
          outputs: |
            dist/snake-dark.svg
            dist/snake-light.svg
            dist/neon-snake.gif
            dist/ocean-snake.gif
        env:
          GITHUB_TOKEN: ${{ env.GH_TOKEN }}

      # Create 3D Contribution Graph
      - name: üìà Generate 3D Contribution Graph
        uses: yoshi389111/github-profile-3d-contrib@0.7.1
        with:
          USERNAME: likhonisaac
          MAX_REPOS: 10
        env:
          GITHUB_TOKEN: ${{ env.GH_TOKEN }}

      # Generate Banner with Custom Graphics
      - name: üé® Generate Custom Profile Banner
        run: |
          mkdir -p banners
          convert -size 1200x400 xc:transparent \
            -font Arial -pointsize 70 -fill '#38BDAE' -gravity center \
            -annotate 0 'Likhon Sheikh' \
            -font Arial -pointsize 40 -fill '#FFFFFF' -gravity center \
            -annotate +0+80 'Full Stack Developer | Open Source Innovator' \
            banners/custom-banner.png

      # Generate Detailed GitHub Stats in Multiple Formats
      - name: üìä GitHub Stats & Analytics
        uses: anuraghazra/github-readme-stats@latest
        with:
          username: likhonisaac
          theme: radical
          include_all_commits: true
          hide_border: true
          cache_seconds: 1800
          output: |
            dist/github-stats-dark.svg
            dist/github-stats-light.svg

      # Deploy Visuals to GitHub Pages
      - name: üì§ Deploy SVGs, GIFs, and Images
        uses: crazy-max/ghaction-github-pages@v3
        with:
          target_branch: output
          build_dir: |
            dist
            banners
        env:
          GITHUB_TOKEN: ${{ env.GH_TOKEN }}

  # Continuous Code Quality Analysis
  code-insights:
    runs-on: ubuntu-latest
    steps:
      - name: üî¨ CodeQL Security Analysis
        uses: github/codeql-action/analyze@v2

      - name: üìä Repository Insights & Metrics
        uses: lowlighter/metrics@latest
        with:
          token: ${{ env.METRICS_TOKEN }}
          base: ""
          plugin_lines: yes
          plugin_lines_sections: base, repositories
          plugin_lines_repositories_limit: 4

  # Dynamic README Update with Generated Visuals
  readme-update:
    runs-on: ubuntu-latest
    steps:
      - name: üîÑ Checkout Repository
        uses: actions/checkout@v4

      - name: üõ†Ô∏è Generate Dynamic README
        run: |
          cat > README.md << EOF
  <div align="center">
    <img src="https://raw.githubusercontent.com/likhonisaac/likhonisaac/output/banners/custom-banner.png" width="100%" alt="Custom Profile Banner"/>

    <a href="https://git.io/typing-svg">
      <img src="https://readme-typing-svg.demolab.com?font=Fira+Code&pause=1000&color=38BDAE&center=true&width=600&lines=üöÄ+Transforming+Ideas+into+Digital+Solutions;üíª+Crafting+Scalable+Applications;üåê+Exploring+Cutting-Edge+Technologies" alt="Typing SVG"/>
    </a>

    <!-- GitHub Stats & Streak Animations -->
    <img src="https://raw.githubusercontent.com/likhonisaac/likhonisaac/output/dist/github-stats-dark.svg" width="49%"/>
    <img src="https://github-readme-streak-stats.herokuapp.com/?user=likhonisaac&theme=radical" width="49%"/>

    <!-- Technology Stack Icons -->
    <img src="https://skillicons.dev/icons?i=js,ts,python,go,react,vue,nodejs,docker,kubernetes,aws" alt="Tech Stack"/>

    <!-- Snake Contribution Animation & 3D Graph -->
    <img src="https://raw.githubusercontent.com/likhonisaac/likhonisaac/output/dist/snake-dark.svg" alt="Snake Animation"/>
    <img src="https://raw.githubusercontent.com/likhonisaac/likhonisaac/output/dist/3d-contrib-graph.svg" alt="3D Contribution Graph"/>

    <!-- Achievements & Visitor Counter -->
    <img src="https://github-profile-trophy.vercel.app/?username=likhonisaac&theme=radical&no-frame=true" alt="Achievements"/>
    <img src="https://komarev.com/ghpvc/?username=likhonisaac&style=for-the-badge&color=38BDAE" alt="Profile Views"/>

    <!-- Social Links -->
    <p>
      <a href="https://t.me/RektDevelopers">
        <img src="https://img.shields.io/badge/Telegram-2CA5E0?style=for-the-badge&logo=telegram&logoColor=white" alt="Telegram"/>
      </a>
      <a href="https://likhon.xyz">
        <img src="https://img.shields.io/badge/Portfolio-38BDAE?style=for-the-badge&logo=web&logoColor=white" alt="Portfolio"/>
      </a>
    </p>
  </div>
  EOF

      - name: üìù Commit and Push README Changes
        run: |
          git config user.name "GitHub Actions Bot"
          git config user.email "<>"
          git add README.md
          git commit -m "ü§ñ Auto-update README with latest metrics and visuals" || exit 0
          git push
